# Versioning

网络API**应该**使用语义版本控制。给定版本号MAJOR.MINOR.PATCH：

1. 当做出不兼容修改的时候，修改MAJOR版本号
2. 当您以向后兼容的方式添加功能时，修改MINOR版本号
3. 当你进行向后兼容的错误修复时，修改PATCH版本号

根据API主要版本号，可使用不同的规则：

* 对于API第一版（v1），其主要版本号应编码进proto包名称中，例如google.pubsub.v1。如果软件包不含有将来有变化的类型和接口，例如google.protobuf和google.longrunning，则可以从proto软件包中省略主版本。
* 对于v1之外的所有版本的API，主版本号必须编码进原包名中。例如，google.pubsub.v2。

对于GA之前的版本，例如alpha和beta，建议在版本号后面附加一个后缀，包括预发布版本名称（例如alpha，beta）和预发布版本号，例如，beta1后缀。

版本升级示例：

版本 | 描述
---|---
v1alpha|	alpha 版本
v1beta1	|beta 版本。因为break可以接受，所以不需要更新版本号
v1beta1|	可信测试版
v1beta2|	可信测试版本迭代
v1test|	带有假数据的可信测试版
v1|	正式发布版
v1.1beta1|	v1小改版的beta版
v1.1|	v1小改版
v2beta1|	新大版本的beta版
v2|	新大版本，正式发布版

minor和patch版本号**应**反映在API配置和文档中，它们**不允许**被编码在原始程序包名称中。

注意：One Platform目前不支持minor和patch版本。 API所有者需要通过API文档和发行说明手动记录它们。

API的新major版本**不应**取决于以前**同样API**的主要版本。 API在了解相关的依赖性和稳定性风险的情况下**可以**依赖其他API。 API**只**应依赖于其他API的最新稳定版本。

在一段时间内，同一API的不同版本必须能够在客户端应用程序中同时工作。这是为了帮助客户端从旧版本平滑过渡到更新版本的API。

旧的API版本**应该**在其弃用期结束后删除。

由许多API共享的公用而稳定的数据类型，例如日期和时间，应在单独的proto包中定义。如果需要进行中断更改，则必须引入新类型名称或具有新MAJOR版本的程序包名称。

## 向后兼容

确定向后兼容的修改是困难的。

以下列表是一份快速参考，如果您有任何疑问，请参阅兼容性部分以了解更多详细信息。

### 向后兼容的修改

* 将API接口添加到API服务定义
* 向API接口添加方法
* 向方法添加HTTP绑定
* 向请求消息中添加字段
* 向响应消息中添加字段
* 向枚举添加值
* 添加仅输出资源字段

### 向后不兼容的修改

* 删除或重命名服务，字段，方法或枚举值
* 更改HTTP绑定
* 更改字段的类型
* 更改资源命名格式
* 更改现有请求的可见行为
* 更改HTTP定义中的URL格式
* 向资源消息添加读/写字段


